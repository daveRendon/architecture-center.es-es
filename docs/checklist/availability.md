---
title: "Lista de comprobación de disponibilidad"
description: "Lista de comprobación que ofrece una guía para las inquietudes sobre disponibilidad durante el diseño."
author: dragon119
ms.date: 03/24/2017
ms.custom: checklist
ms.openlocfilehash: 14e6cd6f25f613ea9793b5cf6c4f1abe6f405b74
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/14/2017
---
# <a name="availability-checklist"></a>Lista de comprobación de disponibilidad
[!INCLUDE [header](../_includes/header.md)]

## <a name="application-design"></a>Diseño de aplicación
* **Evitar los puntos únicos de error.** Todos los componentes, servicios, recursos e instancias de procesos deben implementarse como varias instancias para impedir que un único punto de error afecte a la disponibilidad. Esto incluye mecanismos de autenticación. Diseñe la aplicación para que se configure para usar varias instancias y para detectar errores automáticamente y redirigir las solicitudes a instancias sin errores donde la plataforma no lo hace automáticamente.
* **Descomponer la carga de trabajo según los distintos acuerdos de nivel de servicio.** Si un servicio se compone de cargas de trabajo críticas y menos críticas, adminístrelas de manera diferente y especifique las características de servicio y el número de instancias para satisfacer sus requisitos de disponibilidad.
* **Minimizar y comprender las dependencias de servicio.** Minimice el número de servicios diferentes que se usan siempre que sea posible y asegúrese de que comprende todas las dependencias de características y servicios que existen en el sistema. Esto incluye la naturaleza de estas dependencias y el impacto del error o la reducción del rendimiento de cada una de ellas en la aplicación general. Microsoft garantiza el 99,9 % de disponibilidad como mínimo para la mayoría de los servicios, pero esto significa que cada servicio adicional del que depende una aplicación reduce potencialmente el SLA de disponibilidad general de su sistema en un 0,1 %.
* **Diseñar tareas y mensajes para que sean idempotentes (se repitan de forma segura) siempre que sea posible**, de manera que las solicitudes duplicadas no causen problemas. Por ejemplo, un servicio puede actuar como un consumidor que administra los mensajes enviados como solicitudes por otras partes del sistema que actúan como productores. Si se produce un error en el consumidor tras el procesamiento del mensaje, pero antes de confirmar que se ha procesado, un productor podría enviar una solicitud de repetición que podría ser controlada por otra instancia del consumidor. Por este motivo, los consumidores y las operaciones que se llevan a cabo deben ser idempotentes para que la repetición de una operación ejecutada anteriormente no represente los resultados no válidos. Esto puede significar la detección de mensajes duplicados o garantizar la coherencia mediante un enfoque optimista para tratar los conflictos.
* **Usar un agente de mensajes que implementa alta disponibilidad para las transacciones críticas.** Muchos escenarios para iniciar tareas o acceder a servicios remotos usan mensajería para pasar instrucciones entre la aplicación y el servicio de destino. Para obtener el mejor rendimiento, la aplicación debe ser capaz de enviar el mensaje y, a continuación, volver a procesar más solicitudes sin necesidad de esperar una respuesta. Para garantizar la entrega de mensajes, el sistema de mensajería debe proporcionar una alta disponibilidad. Las colas de mensajes de Azure Service Bus implementan semántica *al menos una vez*. Esto significa que cada mensaje enviado a una cola no se perderá, aunque en determinadas circunstancias se puedan entregar copias duplicadas. Si el procesamiento de mensajes es idempotente (vea el elemento anterior), la entrega repetida no debería ser un problema.
* **Diseñar aplicaciones para degradar de forma correcta** al alcanzar límites de recursos y realizar una acción apropiada para minimizar el impacto para el usuario. En algunos caso, la carga en la aplicación puede superar la capacidad de una o más partes, haciendo que se reduzca la disponibilidad y que se produzcan errores en las conexiones. El ajuste de escala puede ayudar a aliviar esto, pero puede tener un límite determinado por otros factores, como el costo o la disponibilidad de recursos. Diseñe la aplicación para que, en esta situación, puede degradar de manera automática y correcta. Por ejemplo, en un sistema de comercio electrónico, si el subsistema de procesamiento de pedidos está bajo presión (o incluso ha fallado por completo), se puede deshabilitar temporalmente y permitir que continúen otras funciones (por ejemplo, la exploración del catálogo de productos). Podría ser adecuado posponer las solicitudes a un subsistema con errores y permitir, por ejemplo, que los clientes envíen pedidos pero guardarlos para procesarlos más adelante, cuando el subsistema de pedidos vuelva a estar disponible.
* **Administrar correctamente los eventos rápidos de ráfaga.** La mayoría de las aplicaciones necesitan controlar diferentes cargas de trabajo con el tiempo, por ejemplo, los picos a primera hora de la mañana en una aplicación empresarial o cuando se lanza un producto nuevo en un sitio de comercio electrónico. El ajuste de escala automático puede ayudar a controlar la carga, pero se puede tardar algún tiempo en que las instancias adicionales entren en línea y controlen las solicitudes. Impida que las ráfagas repentinas e inesperadas de actividad sobrecarguen la aplicación: diséñela para poner en cola las solicitudes a los servicios que usa y para degradarlas correctamente cuando las colas estén cercanas a la capacidad completa. Asegúrese de que hay suficiente capacidad y rendimiento disponibles en condiciones sin ráfaga para descargar las colas y controlar las solicitudes pendientes. Para obtener más información, vea el [modelo de nivelación de carga basado en cola](https://msdn.microsoft.com/library/dn589783.aspx).

## <a name="deployment-and-maintenance"></a>Implementación y mantenimiento
* **Implementar varias instancias de roles para cada servicio.** Microsoft ofrece garantías de disponibilidad para los servicios que crea e implementa, pero estas garantías solo son válidas si implementa al menos dos instancias de cada rol en el servicio. Esto permite que un rol no esté disponible mientras el otro permanece activo. Esto es especialmente importante si necesita implementar actualizaciones en un sistema activo sin interrumpir las actividades de los clientes; las instancias se pueden desactivar y actualizar individualmente mientras las demás continúan en línea.
* **Hospedar aplicaciones en varios centros de datos.** A pesar de ser muy improbable, es posible que un centro de datos completo pase a estar sin conexión debido a sucesos tales como desastres naturales o errores de Internet. Las aplicaciones empresariales vitales deben estar hospedadas en más de un centro de datos para proporcionar la máxima disponibilidad. De esta forma, también se reduce la latencia para los usuarios locales y se proporcionan oportunidades adicionales al actualizar las aplicaciones.
* **Automatizar y probar las tareas de implementación y mantenimiento.** Las aplicaciones distribuidas constan de varias partes que deben funcionar en conjunto. La implementación se debe, por lo tanto, automatizar mediante mecanismos probados y comprobados, como scripts y aplicaciones de implementación. Estos pueden actualizar y validar la configuración y automatizar el proceso de implementación. También deben usarse técnicas automatizadas para realizar actualizaciones de todas las aplicaciones o de partes de ellas. Es fundamental probar todos estos procesos por completo para asegurarse de que los errores no provocan tiempo de inactividad adicional. Todas las herramientas de implementación deben tener restricciones de seguridad adecuados para proteger la aplicación implementada; defina y aplique directivas de implementación con cuidado y minimice la necesidad de la intervención humana.
* **Considere el uso de las características de ensayo y producción de la plataforma** donde están disponibles. Por ejemplo, con los entornos de ensayo y producción de Azure Cloud Services las aplicaciones pueden pasar de una a otra al instante a través de un intercambio de direcciones IP virtuales (VIP de intercambio). Sin embargo, si prefiere colocar en ensayo un entorno local, o implementar versiones diferentes de la aplicación al mismo tiempo y migrar gradualmente los usuarios, es posible que no pueda usar una operación de intercambio de VIP.
* **Aplicar cambios en la configuración sin reciclar** la instancia cuando sea posible. En muchos casos, los valores de configuración para un servicio o una aplicación de Azure se pueden cambiar sin necesidad de que se reinicie el rol. Los eventos de exposición de rol que se pueden controlar para detectar los cambios de configuración y aplicarlos a los componentes dentro de la aplicación. Sin embargo, algunos cambios en la configuración de la plataforma central requieren el reinicio de un rol. Al crear componentes y servicios, maximice la disponibilidad y minimice el tiempo de inactividad, diseñándolos para aceptar los cambios a los valores de configuración sin necesidad de que se reinicie la aplicación en su conjunto.
* **Usar dominios de actualización para tiempo de inactividad cero durante las actualizaciones.** Las unidades de proceso de Azure, como roles web y de trabajo, se asignan para actualizar dominios. Actualice instancias de rol de grupo de dominios de manera conjunta de modo que, cuando se realice una actualización gradual, cada rol del dominio de actualización se detenga, se actualice y se reinicie por turnos. De esta forma se minimiza el impacto sobre la disponibilidad de aplicaciones. Puede especificar cuántos dominios de actualización se deben crear para un servicio cuando se implementa el servicio.
  
  > [!NOTE]
  > Los roles también se distribuyen en dominios de error, cada uno de los cuales es razonablemente independiente de otros dominios con error en cuanto al bastidor del servidor, la energía y la provisión de refrigeración, con el fin de minimizar la posibilidad de que un error afecte a todas las instancias de rol. Esta distribución se produce automáticamente y no se puede controlar.
  > 
  > 
* **Configurar conjuntos de disponibilidad para máquinas virtuales de Azure.** La colocación de dos o más máquinas virtuales en el mismo conjunto de disponibilidad garantiza que estas máquinas virtuales no se implementarán en el mismo dominio de error. Para maximizar la disponibilidad, debe crear varias instancias de cada máquina virtual crítica usada por el sistema y colocar estas instancias en el mismo conjunto de disponibilidad. Si va a ejecutar varias máquinas virtuales que sirven a diferentes propósitos, cree un conjunto de disponibilidad para cada una. Agregue instancias de cada máquina virtual a cada conjunto de disponibilidad. Por ejemplo, si ha creado máquinas virtuales independientes para que actúen como servidor web y servidor de informes, cree un conjunto de disponibilidad para el servidor web y otro conjunto de disponibilidad para el servidor de informes. Agregue instancias de la máquina virtual del servidor web al conjunto de disponibilidad del servidor web, y agregue instancias de la máquina virtual del servidor de informes al conjunto de disponibilidad de servidor de informes.

## <a name="data-management"></a>Administración de datos

* **Replicación geográfica de los datos en Azure Storage**. Los datos en Azure Storage se replican automáticamente dentro de un centro de datos. Para aún mayor disponibilidad, use el almacenamiento con redundancia geográfica con acceso de lectura (-RAGRS), que replica los datos en una región secundaria y proporciona acceso de solo lectura a los datos en la ubicación secundaria. Los datos son duraderos aun en el caso de una interrupción total o un desastre en la región. Para más información, consulte [Replicación de Azure Storage](/azure/storage/storage-redundancy).
* **Replicación geográfica de bases de datos**. Azure SQL Database y Cosmos DB admiten replicación geográfica, lo que permite configurar réplicas de bases de datos secundarias en otras regiones. Las bases de datos secundarias están disponibles para la consulta y la conmutación por error en caso de una interrupción del centro de datos o de imposibilidad para conectarse a la base de datos principal. Para obtener más información, consulte [Grupos de conmutación por error y replicación geográfica activa](/azure/sql-database/sql-database-geo-replication-overview) (SQL Database) y [Cómo se distribuyen datos globalmente con Azure Cosmos DB](/azure/cosmos-db/distribute-data-globally).
* **Usar simultaneidad optimista y coherencia eventual** siempre que sea posible. Las transacciones que bloquean el acceso a recursos a través del bloqueo (concurrencia pesimista) pueden producir un bajo rendimiento y reducir considerablemente la disponibilidad. Estos problemas pueden ser especialmente importantes en sistemas distribuidos. En muchos casos, las técnicas y un diseño cuidadoso como la creación de particiones pueden minimizar las posibilidades de que se produzcan actualizaciones que generan conflictos. Cuando los datos se replican o se leen desde un almacén actualizado por separado, los datos solo serán coherentes en última instancia. Pero las ventajas superan normalmente con creces el impacto sobre la disponibilidad de uso de las transacciones para garantizar la coherencia inmediata.
* **Usar copias de seguridad periódicas y restauración a un momento dado**y asegurarse de que cumple el objetivo de punto de recuperación (RPO). Realice copias de seguridad de datos regulares y automáticas que no se conserven en otra parte y compruebe que puede restaurar con confiabilidad tanto los datos como la propia aplicación en el que caso de que produzca un error. La replicación de datos no es una característica de copia de seguridad porque los errores e incoherencias introducidas por un error u operaciones malintencionadas se replicarán en todos los almacenes. El proceso de copia de seguridad debe ser seguro para proteger los datos en tránsito y en almacenamiento. Las bases de datos o las partes de un almacén de datos se pueden recuperar normalmente para un momento anterior en el tiempo mediante registros de transacciones. Microsoft Azure ofrece una utilidad de copia de seguridad para los datos almacenados en Azure SQL Database. Los datos se exportan a un paquete de copia de seguridad en el almacenamiento de blobs de Azure y se pueden descargar en una ubicación local segura para almacenarlos.
* **Habilitar la opción de alta disponibilidad para mantener una copia secundaria de una caché de Redis.** Al usar Azure Redis Cache, elija la opción estándar a fin de mantener una copia secundaria del contenido. Para más información, consulte [Uso de Azure Redis Cache](https://msdn.microsoft.com/library/dn690516.aspx).

## <a name="errors-and-failures"></a>Errores
* **Presentar el concepto de un tiempo de espera.** Puede que los servicios y recursos dejen de estar disponibles, provocando errores en las solicitudes. Asegúrese de que los tiempos de espera que aplique sean adecuados para cada servicio o recurso y para el cliente que tiene acceso a ellos. (En algunos casos, puede ser adecuado permitir un tiempo de espera más largo para una instancia determinada de un cliente, según el contexto y otras acciones que realice el cliente.) Tiempos de espera muy breves pueden provocar un número excesivo de operaciones de reintento para servicios y recursos que tienen una latencia considerable. Tiempos de espera muy largos pueden provocar bloqueo si un gran número de solicitudes están en cola, a la espera de que responda un servicio o recurso.
* **Reintentar las operaciones con errores causadas por errores transitorios.** Diseñe una estrategia de reintento para acceder a todos los servicios y recursos donde no admiten de manera inherente el reintento de conexión automática. Use una estrategia que incluya un retraso creciente entre reintentos conforme aumenta el número de errores para evitar la sobrecarga del recurso y para permitirle que recupere y controle de forma correcta las solicitudes en cola. Los reintentos continuos con retrasos muy breves suelen agravar el problema.
* **Detener el envío de solicitudes para evitar los errores en cascada** cuando los servicios remotos no estén disponibles. Puede haber situaciones en las que errores transitorios o de otro tipo, con una gravedad que abarca desde una pérdida parcial de la conectividad hasta el error completo de un servicio, tarden mucho más tiempo del esperado en volver a su estado normal. Además, si un servicio está muy ocupado, el error en una parte del sistema puede provocar errores en cascada y hacer que se bloqueen muchas operaciones mientras se retienen en recursos críticos del sistema como la memoria, los subprocesos y las conexiones de base de datos. En lugar de reintentar continuamente una operación que es improbable que tenga éxito, la aplicación debería aceptar rápidamente que la operación ha generado error y tratar correctamente este error. Puede usar el patrón de interruptor de circuito para rechazar solicitudes para operaciones específicas durante períodos definidos. Para más información, consulte [Circuit Breaker Pattern](../patterns/circuit-breaker.md) (Patrón Circuit Breaker).
* **Componer o revertir a múltiples componentes** para mitigar el impacto de que un servicio específico esté desconectado o no disponible. Diseñe aplicaciones para sacar provecho de varias instancias sin que se vea afectada la operación y las conexiones existentes donde sea posible. Con el fin de maximizar la disponibilidad, use varias instancias y distribuya las solicitudes entre ellas, y detecte y evite el envío de solicitudes a instancias con error.
* **Revertir a un flujo de trabajo o servicio diferente** siempre que sea posible. Por ejemplo, si se produce un error de escritura en SQL Database, almacene temporalmente los datos en el almacenamiento de blobs. Proporcione una instalación para reproducir las escrituras de almacenamiento de blobs en SQL Database cuando el servicio esté disponible. En algunos casos, una operación con error puede tener una acción alternativa que permite que la aplicación continúe trabajando incluso cuando un componente o un servicio produce un error. Si es posible, detecte errores y redirija solicitudes a otros servicios que puedan ofrecer una funcionalidad alternativa adecuada, o a instancias de funciones de copia de seguridad o reducidas que puedan mantener operaciones principales mientras el servicio principal está sin conexión.

## <a name="monitoring-and-disaster-recovery"></a>Supervisión y recuperación ante desastres
* **Proporcionar instrumentación enriquecida para errores probables y eventos de error** para notificar la situación al personal de operaciones. Para los errores que son probables pero que no se han producido todavía, ofrezca datos suficientes para habilitar al personal de operaciones para determinar la causa, mitigar la situación y garantizar que el sistema sigue disponible. Para los errores que ya se han producido, la aplicación debe devolver un mensaje de error adecuado al usuario pero intentará continuar ejecutándose, aunque con funcionalidad reducida. En todos los casos, el sistema de supervisión debe capturar información completa para permitir que el personal de operaciones lleve a cabo una recuperación rápida y, en caso necesario, para que los diseñadores y desarrolladores modifiquen el sistema a fin de evitar que la situación se produzca de nuevo.
* **Supervisar el estado del sistema mediante la implementación de funciones de comprobación.** El mantenimiento y el rendimiento de una aplicación pueden reducirse con el tiempo sin que sea apreciable hasta que se produce un error. Implemente sondeos o funciones de comprobación que se ejecuten con regularidad desde fuera de la aplicación. Estas comprobaciones pueden ser tan simples como la medición del tiempo de respuesta para la aplicación en su conjunto, para las partes individuales de la aplicación, para los servicios individuales que usa la aplicación o para los componentes individuales. Las funciones de comprobación pueden ejecutar procesos para garantizar que producen resultados válidos, para medir la latencia y comprobar la disponibilidad, y para extraer la información del sistema.
* **Probar con regularidad todos los sistemas de conmutación por error y reserva** para asegurarse de que están disponibles y de que funcionan según lo previsto. Los cambios realizados a los sistemas y las operaciones pueden afectar a las funciones de reserva y de conmutación por error, pero es posible que no se detecte el impacto hasta que el sistema principal genere un error o se sobrecargue. Las pruebas anticipadas son necesarias para evitar problemas en directo en tiempo de ejecución.
* **Probar los sistemas de supervisión.** Los sistemas automatizados de conmutación por error y de reserva, así como la visualización manual del rendimiento y el mantenimiento del sistema mediante el uso de paneles, dependen del funcionamiento correcto de la supervisión y la instrumentación. Si estos elementos generan un error, pierden información fundamental o informan de datos imprecisos, es posible que un operador no se dé cuenta de que el sistema está en mal estado o de que tiene errores.
* **Realizar un seguimiento del progreso de los flujos de trabajo de larga ejecución** y volver a intentarlo en caso de error. Los flujos de trabajo de larga ejecución suelen constar de varios pasos. Asegúrese de que cada paso sea independiente y de que se pueda volver a intentar para minimizar la posibilidad de que se tenga que revertir todo el flujo de trabajo o de que se tengan que ejecutar varias transacciones de compensación. Supervise y administre el progreso de los flujos de trabajo de larga ejecución implementando un patrón como [el supervisor del agente del programador](https://msdn.microsoft.com/library/dn589780.aspx).
* **Planear la recuperación ante desastres.** Cree un plan aceptado y probado para la recuperación de cualquier tipo de error que pueda afectar a la disponibilidad del sistema. Elija una arquitectura de recuperación ante desastres multisitio para las aplicaciones críticas. Designe un propietario específico del plan de recuperación ante desastres, incluida la automatización y las pruebas. Asegúrese de que el plan esté bien documentado y automatice el proceso tanto como sea posible. Establezca una estrategia de copia de seguridad para todos los datos transaccionales y de referencia, y pruebe la restauración de estas copias de seguridad con regularidad. Enseñe al personal de operaciones a ejecutar el plan y realizar simulaciones de desastres periódicas para validar y mejorar el plan.
